<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<title>DIARY</title>
		<script language = "javascript">
var XMLHttpRequestObject = false;

var getXMLHTTPRequestObject = function() {
	var XMLHttpRequestObject = false;
	try {
		XMLHttpRequestObject = new ActiveXObject("MSXML2.XMLHTTP");
	} catch (exception1) {
		try {
			XMLHttpRequestObject = new ActiveXObject("Microsoft.XMLHTTP");
		} catch (exception2) {
			XMLHttpRequestObject = false;
		}
	}
	if (!XMLHttpRequestObject && window.XMLHttpRequest) {
		XMLHttpRequestObject = new XMLHttpRequest();
	}
	return XMLHttpRequestObject;
}

var diary_data;
function getJsonData(url)
{
	var XMLHttpRequestObject = getXMLHTTPRequestObject();
	if(XMLHttpRequestObject) {
		XMLHttpRequestObject.open("GET", url);
		XMLHttpRequestObject.setRequestHeader("Content-type", "application/json");
		XMLHttpRequestObject.onreadystatechange = function()
		{
			if (XMLHttpRequestObject.readyState == 4 && XMLHttpRequestObject.status == 200) {
				diary_data = JSON.parse(XMLHttpRequestObject.responseText);
				chDay(2);
			}
		}
		XMLHttpRequestObject.send(null);
	} else {
		console.log("AJAX not supported.");
	}
}
		</script>
	</head>
	<body onload="init()">
		<script language="javascript">
var cur;
function init()
{
	getJsonData('diary.json');
	cur = -1;
	document.getElementById("prevbutton").onclick = function() { chDay(1); };
	document.getElementById("nextbutton").onclick = function() { chDay(2); };
	document.getElementById("prevbutton").disabled = true;
}

function setButtons()
{
	if(cur == 0)
		document.getElementById("prevbutton").disabled = true;
	else if(cur == diary_data.length-1)
		document.getElementById("nextbutton").disabled = true;
	else {
		document.getElementById("prevbutton").disabled = false;
		document.getElementById("nextbutton").disabled = false;
	}
}

function setData(data)
{
	document.getElementById("date").innerHTML = data.date;
	document.getElementById("day").innerHTML = data.day;
	document.getElementById("taskslist").innerHTML = "";
	for(var tsk = 0; tsk < data.tasks.length; tsk++)
		document.getElementById("taskslist").innerHTML += "<li>"+data.tasks[tsk]+"</li>";
}

function chDay(opn) {
	if(opn == 1)
		cur--;
	else if(opn == 2)
		cur++;
	setButtons();
	setData(diary_data[cur]);
}
		</script>
		<h2 id="header">Diary</h2>
		<!-- buttons: next, prev, add -->
		<table>
			<tr>
				<td><input id="prevbutton" type="button" value="prev" /></td>
				<td><input id="nextbutton" type="button" value="next" /></td>
				<td><input id="addbutton" type="button" value="add" /></td>
			</tr>
		</table>
		<div id="date"></div>
		<div id="day"></div>
		<div id="tasks">
			<ul id="taskslist"></ul>
		</div>
	</body>
</html>
